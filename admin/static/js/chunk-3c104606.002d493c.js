(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c104606"],{"19d6":function(e,t,a){},2953:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"admin"},[[a("h4",{staticClass:"title"},[e._v("管理员管理")]),e._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.query,size:"small"}},[a("el-form-item",{attrs:{label:"管理员账号"}},[a("el-input",{attrs:{placeholder:"请输入管理员账号",clearable:""},model:{value:e.query.card_no,callback:function(t){e.$set(e.query,"card_no",t)},expression:"query.card_no"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"时间"}},[a("el-date-picker",{attrs:{type:"datetimerange","picker-options":e.pickerOptions,"value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.query.range,callback:function(t){e.$set(e.query,"range",t)},expression:"query.range"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:function(t){e.dialog.visible=!0}}},[e._v("添加")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData.list,border:"",size:"small"}},[a("el-table-column",{attrs:{width:"80px",prop:"id",label:"id"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{width:"100px",prop:"nickname",label:"昵称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"money",label:"账户余额"}}),e._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"更新时间"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.onUpdateAdmin(t)}}},[e._v("编辑")]),e._v(" "),a("el-popover",{attrs:{placement:"top",title:"提示",width:"200",trigger:"click"},model:{value:t.row.delPopover,callback:function(a){e.$set(t.row,"delPopover",a)},expression:"scope.row.delPopover"}},[a("p",[e._v("确定要删除"+e._s(t.row.username)+"吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.delPopover=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.onDelAdmin(t)}}},[e._v("确定")])],1),e._v(" "),1!=t.row.id?a("el-button",{attrs:{slot:"reference",size:"mini",loading:t.row.loading,type:"danger"},slot:"reference"},[e._v("删除")]):e._e()],1)]}}])})],1),e._v(" "),a("div",{staticClass:"block",staticStyle:{"margin-top":"20px","text-align":"right"}},[a("el-pagination",{attrs:{"current-page":e.query.page,"page-size":e.query.count,layout:"sizes ,prev, pager, next",total:e.tableData.total},on:{"size-change":e.handleSizeChange,"update:currentPage":function(t){return e.$set(e.query,"page",t)},"update:current-page":function(t){return e.$set(e.query,"page",t)},"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"添加管理员",visible:e.dialog.visible,width:"600px"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[a("el-form",{ref:"dialogForm",attrs:{model:e.dialog.form,rules:e.dialog.rules,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("el-input",{attrs:{maxlength:"16",placeholder:"请输入用户名"},model:{value:e.dialog.form.username,callback:function(t){e.$set(e.dialog.form,"username",t)},expression:"dialog.form.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"昵称",prop:"nickname"}},[a("el-input",{attrs:{maxlength:"16",placeholder:"请输入昵称"},model:{value:e.dialog.form.nickname,callback:function(t){e.$set(e.dialog.form,"nickname",t)},expression:"dialog.form.nickname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",maxlength:"16",placeholder:"请输入密码"},model:{value:e.dialog.form.password,callback:function(t){e.$set(e.dialog.form,"password",t)},expression:"dialog.form.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"password1"}},[a("el-input",{attrs:{type:"password",maxlength:"16",placeholder:"请再次输入密码"},model:{value:e.dialog.form.password1,callback:function(t){e.$set(e.dialog.form,"password1",t)},expression:"dialog.form.password1"}})],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:function(t){e.dialog.visible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.dialog.btnLoading},on:{click:function(t){return e.dialogFormSubmit()}}},[e._v("确 定")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"更新管理员密码",visible:e.dialogEdit.visible,width:"600px"},on:{"update:visible":function(t){return e.$set(e.dialogEdit,"visible",t)}}},[a("el-form",{ref:"dialogEditForm",attrs:{model:e.dialogEdit.form,rules:e.dialogEdit.rules,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"username"}},[a("span",[e._v(e._s(e.dialogEdit.form.username))])]),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",maxlength:"16",placeholder:"请输入密码"},model:{value:e.dialogEdit.form.password,callback:function(t){e.$set(e.dialogEdit.form,"password",t)},expression:"dialogEdit.form.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认密码",prop:"password1"}},[a("el-input",{attrs:{type:"password",maxlength:"16",placeholder:"请再次输入密码"},model:{value:e.dialogEdit.form.password1,callback:function(t){e.$set(e.dialogEdit.form,"password1",t)},expression:"dialogEdit.form.password1"}})],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:function(t){e.dialogEdit.visible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.dialogEdit.btnLoading},on:{click:function(t){return e.dialogFormUpdate()}}},[e._v("确 定")])],1)],1)],1)]],2)},r=[],o=a("b775");function l(e){return Object(o["a"])({url:"api.php?a=adminList",method:"get",params:e})}function n(e){return Object(o["a"])({url:"api.php?a=updateAdmin",method:"post",data:e})}function s(e){return Object(o["a"])({url:"api.php?a=addAdmin",method:"post",data:e})}var d={name:"index",data:function(){var e=this,t=function(t,a,i){e.dialog.form.password!==a?i(new Error("两次密码输入不一致")):i()},a=function(t,a,i){e.dialogEdit.form.password!==a?i(new Error("两次密码输入不一致")):i()};return{query:{count:10,page:1},tableData:{list:[],count:0,total:0},tableLoading:!1,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},dialog:{visible:!1,btnLoading:!1,form:{id:0,username:"",nickname:"",password:"",password1:""},rules:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"},{pattern:/^[0-9a-zA-Z]+$/,message:"账号只能输入英文和数字",trigger:"change"}],nickname:[{required:!0,message:"昵称不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,max:19,message:"密码最小长度6位，最大长度16位",trigger:"blur"}],password1:[{required:!0,message:"确认密码不能为空",trigger:"blur"},{validator:t,trigger:["change","blur"]}]}},dialogEdit:{visible:!1,btnLoading:!1,form:{id:0,username:"",password:"",password1:""},rules:{password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,max:19,message:"密码最小长度6位，最大长度16位",trigger:"blur"}],password1:[{required:!0,message:"确认密码不能为空",trigger:"blur"},{validator:a,trigger:["change","blur"]}]}}}},created:function(){this.init()},watch:{"dialog.visible":function(e,t){e||(this.$refs.dialogForm&&this.$refs.dialogForm.resetFields(),this.$refs.dialogForm&&this.$refs.dialogForm.clearValidate())},"dialogEdit.visible":function(e,t){e||(this.$refs.dialogEditForm&&this.$refs.dialogEditForm.resetFields(),this.$refs.dialogEditForm&&this.$refs.dialogEditForm.clearValidate())}},methods:{init:function(){this.netTableData(!0)},onSearch:function(){this.query.page=1,this.netTableData(!0)},netTableData:function(e,t){var a=this;this.tableLoading=e,l(this.query).then(function(e){var i=e.data;a.tableLoading=!1,i.list.map(function(e,t){return e.delPopover=!1,e.loading=!1,e}),a.tableData=i,t&&t()}).catch(function(e){a.$message.error(e),a.tableLoading=!1,t&&t()})},handleCurrentChange:function(){this.netTableData(!0)},handleSizeChange:function(e){this.query.page=1,this.query.count=e,this.netTableData(!0)},onDelAdmin:function(e){e.row.loading=!1,e.row.delPopover=!1,this.$message.error("该管理员账号不能删除啊")},dialogFormSubmit:function(){var e=this;this.$refs.dialogForm.validate(function(t){t&&(e.dialog.btnLoading=!0,s(e.dialog.form).then(function(t){e.dialog.btnLoading=!1,e.dialog.visible=!1,t.success?(e.$message.success(t.data),e.netTableData(!0)):e.$message.error(t.errMsg)}).catch(function(t){e.dialog.btnLoading=!1,e.$message.error(t)}))})},onUpdateAdmin:function(e){this.dialogEdit.visible=!0,this.dialogEdit.form.id=e.row.id,this.dialogEdit.form.username=e.row.username},dialogFormUpdate:function(){var e=this;this.$refs.dialogEditForm.validate(function(t){t&&(e.dialogEdit.btnLoading=!0,n(e.dialogEdit.form).then(function(t){e.dialogEdit.btnLoading=!1,e.dialogEdit.visible=!1,t.success?e.$message.success(t.data):e.$message.error(t.errMsg)}).catch(function(t){e.dialogEdit.btnLoading=!1,e.$message.error(t)}))})}}},c=d,u=(a("8416"),a("2877")),m=Object(u["a"])(c,i,r,!1,null,null,null);t["default"]=m.exports},8416:function(e,t,a){"use strict";var i=a("19d6"),r=a.n(i);r.a}}]);